#version 430

uniform float Aspect;

layout(points)in;

layout(triangle_strip, max_vertices = 512 )out;

in	vec4 position[];

out vec2 UV;

#include TransformDefinition;

#include CharactersData;

void emitQuad(mat4 transform,vec4 pos,vec2 UV_LU, vec2 UV_RB,vec2 UV_shift, float width, float height)
{
	vec2 LU = UV_LU + UV_shift;
	
	vec2 RD = UV_RB + UV_shift;
	
	float w = width/Aspect/2;
	
	float h = height/2;
	
	UV = vec2(LU.x,LU.y);
	
	gl_Position = transform*(vec4(-w,h,0,0) + pos);
	
	EmitVertex();	
	////
	UV = vec2(LU.x,RD.y);
	
	gl_Position = transform*(vec4(-w,-h,0,0) + pos);
	
	EmitVertex();	
	///
	UV = vec2(RD.x,LU.y);
	
	gl_Position = transform*(vec4(w,h,0,0) + pos);
	
	EmitVertex();	
	///
	UV = vec2(RD.x,RD.y);
	
	gl_Position = transform*(vec4(w,-h,0,0) + pos);
	
	EmitVertex();	

	EndPrimitive();
}


void main()
{
	mat4 transform = worldTransform*parentTransform;

	//emitQuad( transform, position[0], vec2(0,0), vec2(1,1), vec2(0,0), 1, 1);
	
	float hstp = 0;
	
    vec4 pos;
	
	float t = fillnes;
	
	int r =  int(rows);
	
	float x = 0;
	float y = 0;
	
	for(int i = 0; i < 3; ++i)
	{
	 
 
		emitQuad( transform,  
		position[0], 
		vec2(0,0),
		vec2(1,1),
		vec2(0,0)
		,0.4, 0.4);
	}
	
}